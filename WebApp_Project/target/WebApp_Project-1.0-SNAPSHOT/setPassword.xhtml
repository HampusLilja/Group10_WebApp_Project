<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core">
    <head>
        
        <link rel="stylesheet" type="text/css" href="client/css/newcss.css"/>
	
        <title>Grupp 10</title>
	
        <script type="text/javascript" src="client/js/lib/jquery-1.7.1.min"></script>
                <script type="text/javascript">
// <![CDATA[
  function checkPassword(str)
  {
    var re = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])\w{6,}$/;
    return re.test(str);
  }

  function checkForm(form)
  {
    if(form.username.value == "") {
      alert("Error: Username cannot be blank!");
      form.username.focus();
      return false;
    }
    re = /^\w+$/;
    if(!re.test(form.username.value)) {
      alert("Error: Username must contain only letters, numbers and underscores!");
      form.username.focus();
      return false;
    }
    if(form.pwd1.value != "" && form.pwd1.value == form.pwd2.value) {
      if(!checkPassword(form.pwd1.value)) {
        alert("The password you have entered is not valid!");
        form.pwd1.focus();
        return false;
      }
    } else {
      alert("Error: Please check that you've entered and confirmed your password!");
      form.pwd1.focus();
      return false;
    }
    return true;
  }
// ]]>
</script>
    </head>
    <!-- body -->
	<body>
		<!-- HEADER -->
		<div id="header">
                    <img src="client/img/logo.png"/>
		</div>
		<!-- ENDS HEADER -->	
  
  		<!-- Menu -->
			<menu>
				<!-- Navigation -->
					<nav>
                                        	<ul>
						<li><a href="index.xhtml">Home</a></li>
						<li><a href="shop.xhtml">Shop</a></li>
						<li><a href="contact.xhtml">Contact</a></li>
                                                <li><a href="signup.xhtml">Login/Sign up</a></li>
						</ul>
					</nav>
				<!-- Navigation -->
					
			</menu>
		<!-- ENDS Menu -->

		<!-- MAIN -->
                <div id="main">
                                                                                                                                                
                                                                <form id="loginForm" method="POST" action="form-handler.php"  onsubmit="return checkForm(this);">
                                                                    <p>Password: <input type="password" required="true" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])\w{6,}" 
                                                                                        name="pwd1" onchange="this.setCustomValidity(this.validity.patternMismatch ? 
                                                                                                'Password must contain at least 6 characters, including UPPER/lowercase and numbers' : '');
                                                                                            if(this.checkValidity()) form.pwd2.pattern = this.value;"/></p>
                                                                    <p>Confirm Password: <input type="password" required="true" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])\w{6,}" 
                                                                                                name="pwd2" onchange="this.setCustomValidity(this.validity.patternMismatch ? 
                                                                                                        'Please enter the same Password as above' : '');"/></p>
                                                                    <p><input type="submit" value="Check" name="check" id="submit" /></p>
                                                                </form>
							
                            
                    <h:body>
                        <h:dataTable var="customer" value="#{customers.all}" border="1" >
                            <h:column>
                                <f:facet name="header">ID</f:facet>
                                #{customer.ID}
                            </h:column>
                            <h:column>
                                <f:facet name="header">First Name</f:facet>
                                #{customer.firstName}
                            </h:column>
                            <h:column>
                                <f:facet name="header">Last Name</f:facet>
                                #{customer.lastName}
                            </h:column>
                            <h:column>
                                <f:facet name="header">Address</f:facet>
                                #{customer.address.toString()}
                                <h:form>
                                    <h:commandLink actionListener="#{conversation.addressActionListener(
                                                                     customer.ID, customer.firstName, customer.lastName, 
                                                                     customer.address.street, customer.address.number, 
                                                                     customer.address.zip, customer.address.town)}"
                                    action="editAddressDetails" >Edit</h:commandLink>
                                </h:form>
                            </h:column>
                            <h:column>
                                <f:facet name="header">Contact Info</f:facet>
                                #{customer.contactInfo.toString()}
                                <h:form>
                                    <h:commandLink actionListener="#{conversation.contactActionListener(
                                                                     customer.ID, customer.firstName, customer.lastName, 
                                                                     customer.contactInfo.phoneNumber, customer.contactInfo.email, 
                                                                     customer.contactInfo.website, customer.contactInfo.comments)}"
                                    action="editContactDetails" >Edit</h:commandLink>
                                </h:form>
                            </h:column>
                            <h:column>
                                <f:facet name="header">Delete</f:facet>
                                <h:form>
                                    <h:commandLink actionListener="#{conversation.deleteActionListener(
                                                                     customer.ID, customer.firstName, customer.lastName,
                                                                     customer.contactInfo.email)}"
                                    action="deleteCustomer" >Delete</h:commandLink>
                                </h:form>
                            </h:column>

                        </h:dataTable></h:body>
                    
                </div>
		<!-- ENDS MAIN -->
  
		
        <!-- FOOTER -->
		<footer>
                    <p> Footer content goes here </p>
                    <p>&#169; Grupp 10 Webbapplikationer</p>
		</footer>
		<!-- ENDS FOOTER -->

    </body>
	<!-- ENDS body -->
</html>
